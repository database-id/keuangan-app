<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wafi Family Finance</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="page">
        <div class="login-container">
            <div class="login-header">
                <h1>Wafi Family Finance</h1>
                <p>Manage your household finances wisely</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Enter username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter password" required>
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
                <p class="register-link">Don't have an account? <a href="#" id="showRegister">Register here</a></p>
            </form>

            <!-- REGISTER FORM -->
            <form id="registerForm" class="login-form" style="display:none;">
                <div class="form-group">
                    <label for="regUsername">Username</label>
                    <input type="text" id="regUsername" placeholder="Create username" required>
                </div>
                <div class="form-group">
                    <label for="regPassword">Password</label>
                    <input type="password" id="regPassword" placeholder="Create password" required>
                </div>
                <div class="form-group">
                    <label for="regConfirm">Confirm Password</label>
                    <input type="password" id="regConfirm" placeholder="Repeat password" required>
                </div>
                <div class="form-group">
                    <label for="regGaji">Monthly Salary (Rp)</label>
                    <input type="number" id="regGaji" placeholder="6000000" value="6000000" required>
                </div>
                <button type="submit" class="btn btn-primary">Register</button>
                <p class="register-link"><a href="#" id="showLogin">Already have an account? Login</a></p>
            </form>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="mainApp" class="page" style="display:none;">
        <!-- SIDEBAR -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>Wafi Family Finance</h2>
                <p id="welcomeUser">Halo, User!</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-page="dashboard">
                    <span class="icon">üìä</span> Dashboard
                </li>
                <li class="nav-item" data-page="transaksi">
                    <span class="icon">üí∞</span> Transaction
                </li>
                <li class="nav-item" data-page="tabungan">
                    <span class="icon">üè¶</span> Savings
                </li>
                <li class="nav-item" data-page="budget">
                    <span class="icon">üìã</span> Budget
                </li>
                <li class="nav-item" data-page="laporan">
                    <span class="icon">üìà</span> Report
                </li>
                <li class="nav-item" data-page="pengaturan">
                    <span class="icon">‚öôÔ∏è</span> Settings
                </li>
            </ul>
            <button class="btn btn-logout" id="logoutBtn">Logout</button>
        </nav>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- DASHBOARD -->
            <section id="dashboardSection" class="content-section">
                <h2>Financial Dashboard</h2>
                <div class="month-selector">
                    <label>Month:</label>
                    <input type="month" id="dashboardMonth">
                </div>

                <div class="quick-actions">
                    <button class="btn btn-success" onclick="showQuickIncome()">+ Add Income</button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card income">
                        <h3>Total Income</h3>
                        <p id="totalIncome">Rp 0</p>
                        <small>This month</small>
                    </div>
                    <div class="stat-card expense">
                        <h3>Total Expense</h3>
                        <p id="totalExpense">Rp 0</p>
                        <small>This month</small>
                    </div>
                    <div class="stat-card balance">
                        <h3>Balance</h3>
                        <p id="totalBalance">Rp 0</p>
                        <small>This month</small>
                    </div>
                </div>

                <div class="budget-overview">
                    <h3>Budget Status This Month</h3>
                    <div class="budget-cards">
                        <div class="budget-card living">
                            <h4>üè† Living</h4>
                            <div class="budget-info">
                                <span>Budget: <strong id="livingBudget">Rp 0</strong></span>
                                <span>Used: <strong id="livingUsed">Rp 0</strong></span>
                                <span>Remaining: <strong id="livingRemain">Rp 0</strong></span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="livingProgress"></div>
                            </div>
                        </div>
                        <div class="budget-card saving">
                            <h4>üíé Saving</h4>
                            <div class="budget-info">
                                <span>Target: <strong id="savingBudget">Rp 0</strong></span>
                                <span>Saved: <strong id="savingUsed">Rp 0</strong></span>
                                <span>Remaining: <strong id="savingRemain">Rp 0</strong></span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress saving-progress" id="savingProgress"></div>
                            </div>
                        </div>
                        <div class="budget-card playing">
                            <h4>üéÆ Playing</h4>
                            <div class="budget-info">
                                <span>Budget: <strong id="playingBudget">Rp 0</strong></span>
                                <span>Used: <strong id="playingUsed">Rp 0</strong></span>
                                <span>Remaining: <strong id="playingRemain">Rp 0</strong></span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress playing-progress" id="playingProgress"></div>
                            </div>
                        </div>
                        <div class="budget-card emergency">
                            <h4>üö® Emergency</h4>
                            <div class="budget-info">
                                <span>Budget: <strong id="emergencyBudget">Rp 0</strong></span>
                                <span>Used: <strong id="emergencyUsed">Rp 0</strong></span>
                                <span>Remaining: <strong id="emergencyRemain">Rp 0</strong></span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress emergency-progress" id="emergencyProgress"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-box">
                        <h3>Expense Distribution</h3>
                        <canvas id="expenseChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3>Monthly Trend</h3>
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <div class="recent-transactions">
                    <h3>Recent Transactions</h3>
                    <div id="recentList"></div>
                </div>
            </section>

            <!-- TRANSAKSI -->
            <section id="transaksiSection" class="content-section" style="display:none;">
                <h2>Manage Transactions</h2>

                <div class="transaction-form-container">
                    <form id="transactionForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Type</label>
                                <select id="txType" required>
                                    <option value="expense">Expense</option>
                                    <option value="income">Income</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select id="txCategory" required>
                                    <option value="living">Living</option>
                                    <option value="saving">Saving</option>
                                    <option value="playing">Playing</option>
                                    <option value="emergency">Emergency</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Amount (Rp)</label>
                                <input type="number" id="txAmount" placeholder="100000" required>
                            </div>
                            <div class="form-group">
                                <label>Date</label>
                                <input type="date" id="txDate" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" id="txDescription" placeholder="Example: Monthly shopping">
                        </div>
                        <button type="submit" class="btn btn-primary">Add Transaction</button>
                    </form>
                </div>

                <div class="transaction-filters">
                    <input type="month" id="filterMonth">
                    <select id="filterType">
                        <option value="all">All Types</option>
                        <option value="income">Income</option>
                        <option value="expense">Expense</option>
                    </select>
                    <select id="filterCategory">
                        <option value="all">All Categories</option>
                        <option value="living">Living</option>
                        <option value="saving">Saving</option>
                        <option value="playing">Playing</option>
                        <option value="emergency">Emergency</option>
                    </select>
                </div>

                <div class="transaction-list" id="transactionList"></div>
            </section>

            <!-- TABUNGAN -->
            <section id="tabunganSection" class="content-section" style="display:none;">
                <h2>My Savings</h2>
                <p class="section-desc">Track your savings progress over time</p>

                <div class="savings-overview">
                    <div class="savings-main-card">
                        <div class="savings-icon">üí∞</div>
                        <div class="savings-info">
                            <h3>Total Accumulated Savings</h3>
                            <p id="accumulatedSavings">Rp 0</p>
                            <small>Accumulated balance from all months</small>
                        </div>
                    </div>
                </div>

                <div class="savings-charts">
                    <div class="chart-box">
                        <h3>Savings Growth Chart</h3>
                        <canvas id="savingsLineChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3>Monthly Balance</h3>
                        <canvas id="savingsBarChart"></canvas>
                    </div>
                </div>

                <div class="savings-history-section">
                    <h3>Monthly Balance History</h3>
                    <div class="savings-history-table">
                        <div class="history-header">
                            <span>Month</span>
                            <span>Income</span>
                            <span>Expense</span>
                            <span>Balance</span>
                        </div>
                        <div id="savingsHistoryList"></div>
                    </div>
                </div>
            </section>

            <!-- BUDGET -->
            <section id="budgetSection" class="content-section" style="display:none;">
                <h2>Budget Allocation</h2>
                <p class="section-desc">Set your monthly salary budget percentages</p>

                <div class="budget-settings">
                    <div class="gaji-setting">
                        <label>Monthly Salary</label>
                        <input type="number" id="gajiInput" placeholder="6000000">
                        <button class="btn btn-secondary" id="updateGaji">Update Salary</button>
                    </div>

                    <div class="percentage-settings">
                        <div class="percentage-item">
                            <label>üè† Living (Essentials)</label>
                            <div class="percentage-input">
                                <input type="range" id="livingPercent" min="0" max="100" value="50">
                                <span id="livingPercentValue">50%</span>
                            </div>
                            <p class="amount-preview">= Rp <span id="livingAmount">0</span></p>
                        </div>
                        <div class="percentage-item">
                            <label>üíé Saving</label>
                            <div class="percentage-input">
                                <input type="range" id="savingPercent" min="0" max="100" value="30">
                                <span id="savingPercentValue">30%</span>
                            </div>
                            <p class="amount-preview">= Rp <span id="savingAmount">0</span></p>
                        </div>
                        <div class="percentage-item">
                            <label>üéÆ Playing (Entertainment)</label>
                            <div class="percentage-input">
                                <input type="range" id="playingPercent" min="0" max="100" value="10">
                                <span id="playingPercentValue">10%</span>
                            </div>
                            <p class="amount-preview">= Rp <span id="playingAmount">0</span></p>
                        </div>
                        <div class="percentage-item emergency-item">
                            <label>üö® Emergency Fund</label>
                            <div class="percentage-input">
                                <input type="range" id="emergencyPercent" min="0" max="100" value="10">
                                <span id="emergencyPercentValue">10%</span>
                            </div>
                            <p class="amount-preview">= Rp <span id="emergencyAmount">0</span></p>
                        </div>
                    </div>

                    <div class="total-percentage">
                        <span>Total: <strong id="totalPercent">100%</strong></span>
                        <span id="percentWarning" class="warning" style="display:none;">Total must be 100%!</span>
                    </div>

                    <button class="btn btn-primary" id="saveBudget">Save Budget Settings</button>
                </div>
            </section>

            <!-- LAPORAN -->
            <section id="laporanSection" class="content-section" style="display:none;">
                <h2>Financial Report</h2>

                <div class="report-filters">
                    <div class="form-group">
                        <label>Period</label>
                        <select id="reportPeriod">
                            <option value="month">Monthly</option>
                            <option value="year">Yearly</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Month/Year</label>
                        <input type="month" id="reportMonth">
                    </div>
                    <button class="btn btn-secondary" id="generateReport">Show Report</button>
                </div>

                <div class="report-summary">
                    <div class="report-card">
                        <h4>Period Summary</h4>
                        <div class="report-stats">
                            <div class="report-stat">
                                <span>Total Income</span>
                                <strong id="reportIncome">Rp 0</strong>
                            </div>
                            <div class="report-stat">
                                <span>Total Expense</span>
                                <strong id="reportExpense">Rp 0</strong>
                            </div>
                            <div class="report-stat">
                                <span>Difference</span>
                                <strong id="reportDiff">Rp 0</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="report-details">
                    <div class="report-chart">
                        <h4>Expense by Category Chart</h4>
                        <canvas id="reportPieChart"></canvas>
                    </div>
                    <div class="report-breakdown">
                        <h4>Category Breakdown</h4>
                        <div id="categoryBreakdown"></div>
                    </div>
                </div>

                <div class="export-section">
                    <button class="btn btn-secondary" id="exportCSV">Export CSV</button>
                </div>

                <!-- ANALISIS & SARAN -->
                <div class="analysis-section">
                    <h3>Financial Analysis & Suggestions</h3>

                    <div class="analysis-cards">
                        <!-- Skor Kesehatan Keuangan -->
                        <div class="analysis-card health-score">
                            <h4>Financial Health Score</h4>
                            <div class="score-circle">
                                <span id="healthScore">0</span>
                                <small>/100</small>
                            </div>
                            <p id="healthStatus" class="health-status">-</p>
                        </div>

                        <!-- Ringkasan Analisis -->
                        <div class="analysis-card summary">
                            <h4>Summary</h4>
                            <div class="analysis-stats">
                                <div class="analysis-stat">
                                    <span>Saving Ratio</span>
                                    <strong id="savingRatio">0%</strong>
                                </div>
                                <div class="analysis-stat">
                                    <span>Expense Ratio</span>
                                    <strong id="expenseRatio">0%</strong>
                                </div>
                                <div class="analysis-stat">
                                    <span>Budget Remaining</span>
                                    <strong id="budgetRemaining">Rp 0</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Detail Analisis per Kategori -->
                    <div class="category-analysis">
                        <h4>Category Analysis</h4>
                        <div id="categoryAnalysis"></div>
                    </div>

                    <!-- Saran Keuangan -->
                    <div class="suggestions-section">
                        <h4>Suggestions & Recommendations</h4>
                        <div id="financialSuggestions"></div>
                    </div>

                    <!-- Tips Keuangan -->
                    <div class="tips-section">
                        <h4>Financial Tips</h4>
                        <div id="financialTips"></div>
                    </div>
                </div>
            </section>

            <!-- PENGATURAN -->
            <section id="pengaturanSection" class="content-section" style="display:none;">
                <h2>Account Settings</h2>

                <div class="settings-container">
                    <div class="setting-card">
                        <h3>Change Password</h3>
                        <form id="changePasswordForm">
                            <div class="form-group">
                                <label>Old Password</label>
                                <input type="password" id="oldPassword" required>
                            </div>
                            <div class="form-group">
                                <label>New Password</label>
                                <input type="password" id="newPassword" required>
                            </div>
                            <div class="form-group">
                                <label>Confirm New Password</label>
                                <input type="password" id="confirmNewPassword" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Change Password</button>
                        </form>
                    </div>

                    <div class="setting-card danger">
                        <h3>Data & Backup</h3>
                        <p>Export all your financial data</p>
                        <button class="btn btn-secondary" id="exportData">Export Data (JSON)</button>
                        <hr>
                        <p>Import data from backup</p>
                        <input type="file" id="importFile" accept=".json">
                        <button class="btn btn-secondary" id="importData">Import Data</button>
                        <hr>
                        <p class="warning-text">Delete all data (cannot be undone!)</p>
                        <button class="btn btn-danger" id="clearData">Delete All Data</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODAL TAMBAH PEMASUKAN -->
    <div id="incomeModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeIncomeModal()">&times;</span>
            <h3>Add Income</h3>
            <form id="quickIncomeForm">
                <div class="form-group">
                    <label>Amount (Rp)</label>
                    <input type="number" id="quickIncomeAmount" placeholder="500000" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <input type="text" id="quickIncomeDesc" placeholder="Example: Bonus, Freelance, THR">
                </div>
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="quickIncomeDate" required>
                </div>
                <button type="submit" class="btn btn-success">Save Income</button>
            </form>
        </div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast"></div>

    <script src="app.js"></script>
</body>
</html>
